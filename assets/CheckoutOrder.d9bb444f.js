import{_ as Z,s as ee,f as oe,u as te,i as se,g as M,I as A,h as p,B as ae,r as c,M as ne,o as h,c as y,K as le,a as e,b as a,w as l,F as G,A as I,N as w,e as _,t as r,m as i,O as re,k as de,n as ce,R as ie,l as pe,p as _e,q as ue}from"./index.e83bda25.js";import{A as ge}from"./AddAddress.8eb07cd5.js";const d=v=>(_e("data-v-9d43b728"),v=v(),ue(),v),xe={class:"py-6 border-b-2 border-solid my-shop-car-header","element-loading-text":"\u6B63\u5728\u63D0\u4EA4\u8BA2\u5355"},me={class:"container m-auto flex flex-row items-center"},fe=d(()=>e("div",{class:"text-[22px] ml-10 flex-1"},"\u786E\u8BA4\u8BA2\u5355",-1)),he={class:"self-end"},ye={class:"el-dropdown-link text-gray-500 font-bold"},ve=d(()=>e("span",{class:"mx-2 text-gray-400"},"|",-1)),be=d(()=>e("span",null,"\u6211\u7684\u8BA2\u5355",-1)),Ce={class:"bg-gray-100 overflow-auto"},Ie={class:"container m-auto mt-[40px] p-[20px] bg-white"},we=d(()=>e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u6536\u8D27\u5730\u5740",-1)),ke={class:"address-list"},Oe=["onClick"],Le={class:"text-[18px]"},Ae={class:"text-gray-600"},Se={class:"address-all"},De={class:"h-[200px] flex flex-row justify-center items-center border border-solid border-gray-400 p-6 box-border leading-7"},Ee=d(()=>e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u5546\u54C1\u53CA\u4F18\u60E0\u5377",-1)),Be={class:"text-[12px]"},Ne={class:"text-primaryColor"},Ve=d(()=>e("div",{class:"flex flex-row h-[80px] items-center border-b border-solid border-gray-200"},[e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u914D\u9001\u65B9\u5F0F"),e("span",{class:"text-primaryColor ml-10 text-[14px]"},"\u5305\u90AE")],-1)),$e=d(()=>e("div",{class:"flex flex-row h-[80px] items-center border-b border-solid border-gray-200"},[e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u53D1\u7968"),e("span",{class:"text-primaryColor ml-10 text-[14px]"},"\u7535\u5B50\u666E\u901A\u53D1\u7968\u4E2A\u4EBA\u5546\u54C1\u660E\u7EC6\u4FEE\u6539 >")],-1)),Me={class:"total-info-ul"},Ge=d(()=>e("span",null,"\u5546\u54C1\u603B\u4EF6\u6570\uFF1A",-1)),Pe={class:"text-primaryColor"},Re=d(()=>e("span",null,"\u5546\u54C1\u603B\u4EF7\uFF1A",-1)),Te={class:"text-primaryColor"},Ue=d(()=>e("li",null,[e("span",null,"\u6D3B\u52A8\u4F18\u60E0\uFF1A"),e("span",{class:"text-primaryColor"},"-0\u5143")],-1)),je=d(()=>e("li",null,[e("span",null,"\u4F18\u60E0\u5238\u62B5\u6263\uFF1A"),e("span",{class:"text-primaryColor"},"-0\u5143")],-1)),qe=d(()=>e("li",null,[e("span",null,"\u8FD0\u8D39\uFF1A"),e("span",{class:"text-primaryColor"},"0\u5143")],-1)),Fe={class:"flex flex-row items-end"},ze=d(()=>e("span",null,"\u5E94\u4ED8\u603B\u989D\uFF1A",-1)),He={class:"text-primaryColor text-[28px]"},Je={class:"flex flex-row justify-end mt-[20px] box-border"},Ke=d(()=>e("div",{class:"h-[10px] bg-gray-100"},null,-1)),Qe={__name:"CheckoutOrder",setup(v){const S=ee(),P=oe(),k=te(),R=se("baseURL"),u=M({pageIndex:1}),n=M({listData:[],pageCount:0,pageEnd:0,pageIndex:1,pageStart:1,totalCount:0}),T=A(()=>S._loginUserInfo),g=p(!1),D=s=>{g.value=!0,I.addressInfo.getMyAddressInfoList(u.pageIndex).then(o=>{n.listData=o.listData,n.pageCount=o.pageCount,n.pageEnd=o.pageEnd,n.pageIndex=o.pageIndex,n.pageStart=o.pageStart,n.totalCount=o.totalCount}).finally(()=>{g.value=!1})};D(u.pageIndex);const x=p(!1);ae(x,(s,o)=>{s===!1&&D(u.pageIndex)});const b=p(-1),U=()=>{n.pageIndex<n.pageCount&&(u.pageIndex++,g.value=!0,I.addressInfo.getMyAddressInfoList(u.pageIndex).then(s=>{n.listData=s.listData,n.pageCount=s.pageCount,n.pageEnd=s.pageEnd,n.pageIndex=s.pageIndex,n.pageStart=s.pageStart,n.totalCount=s.totalCount}).finally(()=>{g.value=!1,console.log(n)}))},O=p(!1),m=p([]);(()=>{O.value=!0;let s=P.params.Ids;I.shopCarInfo.getMyCheckoutShopCarList(s).then(o=>{o.forEach(C=>{C.goodsInfo.goods_photo=JSON.parse(C.goodsInfo.goods_photo)}),m.value=o}).catch(()=>{w.alert("\u83B7\u53D6\u786E\u8BA4\u8BA2\u5355\u7684\u5546\u54C1\u6570\u636E\u5931\u8D25")}).finally(o=>{O.value=!1})})();const j=A(()=>{let s=0;return m.value.forEach(o=>{s+=o.car_goods_num}),s}),E=A(()=>{let s=0;return m.value.forEach(o=>{s+=o.car_goods_num*o.goodsInfo.goods_sale_price}),s}),L=p(!1),q=()=>{if(b.value===-1){w.alert("\u8BF7\u9009\u62E9\u6536\u8D27\u5730\u5740","\u63D0\u793A");return}L.value=!0;let s={address_id:n.listData[b.value].id,order_pay_type:1,goodsList:m.value.map(o=>({goods_id:o.goods_id,goods_num:o.car_goods_num}))};I.orderInfo.submitOrder(s).then(({data:o})=>{k.replace({name:"confirmOrder",params:{id:o}})}).catch(()=>{w.alert("\u63D0\u4EA4\u8BA2\u5355\u5931\u8D25","\u63D0\u793A",{type:"error"})}).finally(()=>{L.value=!1})},F=s=>{s==="CustomCenter"?k.push({name:"CustomCenter"}):s==="logOut"&&z()},z=()=>{w.confirm("\u786E\u5B9A\u8981\u9000\u51FA\u767B\u5F55\u5417\uFF1F","\u8BE2\u95EE",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(()=>{S.logOut(),k.push({name:"Login"})}).catch(()=>{console.log("\u53D6\u6D88\u9000\u51FA\u767B\u5F55")})};return(s,o)=>{const C=c("el-icon"),B=c("el-dropdown-item"),H=c("el-dropdown-menu"),J=c("el-dropdown"),N=c("el-button"),V=c("el-skeleton"),f=c("el-table-column"),K=c("el-image"),Q=c("el-table"),W=c("site-footer"),X=c("el-dialog"),Y=ne("loading");return h(),y(G,null,[le((h(),y("div",xe,[e("div",me,[e("div",{class:"iconfont icon-icon-xiaomiguishu text-[56px] text-[#ff6a00] ml-20 cursor-pointer",onClick:o[0]||(o[0]=t=>s.$router.replace({name:"Home"}))}),fe,e("div",he,[a(J,{onCommand:F},{dropdown:l(()=>[a(H,null,{default:l(()=>[a(B,{command:"CustomCenter"},{default:l(()=>[_("\u4E2A\u4EBA\u4E2D\u5FC3")]),_:1}),a(B,{divided:"",command:"logOut"},{default:l(()=>[_("\u9000\u51FA\u767B\u5F55")]),_:1})]),_:1})]),default:l(()=>{var t;return[e("span",ye,[_(r((t=i(T))==null?void 0:t.custom_realName)+" ",1),a(C,{class:"el-icon--right"},{default:l(()=>[a(i(re))]),_:1})]),ve,be]}),_:1})])])])),[[Y,L.value]]),e("div",Ce,[e("div",Ie,[we,a(V,{animated:"",loading:g.value},{default:l(()=>[e("div",ke,[(h(!0),y(G,null,de(n.listData,(t,$)=>(h(),y("div",{class:ce(["address-item",{selected:b.value===$}]),onClick:Xe=>b.value=$,key:t.id},[e("div",Le,r(t.address_name),1),e("p",Ae,r(t.address_tel.substr(0,3)+"****"+t.address_tel.slice(-4)),1),e("p",Se,r(t.province)+" "+r(t.city)+" "+r(t.area)+" "+r(t.address_detail),1),a(N,{type:"text",class:"absolute right-6 bottom-2"},{default:l(()=>[_("\u4FEE\u6539")]),_:1})],10,Oe))),128)),e("div",De,[a(N,{icon:i(ie),type:"text",onClick:o[1]||(o[1]=t=>x.value=!0)},{default:l(()=>[_(" \u65B0\u589E\u5730\u5740 ")]),_:1},8,["icon"])])]),n.pageIndex<n.pageCount?(h(),y("div",{key:0,class:"flex flex-row h-[40px] justify-center items-center my-5 bg-gray-100 cursor-pointer text-gray-500",onClick:U}," \u52A0\u8F7D\u4E0B\u4E00\u9875\u5730\u5740\u6570\u636E ")):pe("",!0)]),_:1},8,["loading"]),a(V,{animated:"",loading:O.value},{default:l(()=>[Ee,a(Q,{data:m.value,class:"w-full"},{default:l(()=>[a(f,{label:"\u7F16\u53F7",width:"60",align:"center"},{default:l(({$index:t})=>[_(r(t+1),1)]),_:1}),a(f,{label:"\u56FE\u7247",width:"100",align:"center"},{default:l(({row:t})=>[a(K,{src:i(R)+t.goodsInfo.goods_photo[0],class:"w-[60px] h-[60px]"},null,8,["src"])]),_:1}),a(f,{prop:"goodsInfo.goods_name",label:"\u5546\u54C1\u540D\u79F0"}),a(f,{label:"\u4EF7\u683C\u6570\u91CF",width:"200",align:"center"},{default:l(({row:t})=>[e("span",Be,r(t.goodsInfo.goods_sale_price)+"\u5143 x "+r(t.car_goods_num),1)]),_:1}),a(f,{label:"\u603B\u4EF7",width:"120"},{default:l(({row:t})=>[e("span",Ne,r(t.goodsInfo.goods_sale_price*t.car_goods_num),1)]),_:1})]),_:1},8,["data"]),Ve,$e,e("ul",Me,[e("li",null,[Ge,e("span",Pe,r(i(j))+"\u4EF6",1)]),e("li",null,[Re,e("span",Te,r(i(E))+"\u5143",1)]),Ue,je,qe,e("li",Fe,[ze,e("span",He,r(i(E))+"\u5143",1)])]),e("div",Je,[e("button",{type:"button",class:"w-[180px] h-[40px] border border-solid border-gray-400 text-gray-400",onClick:o[2]||(o[2]=t=>s.$router.back())},"\u8FD4\u56DE\u8D2D\u7269\u8F66 "),e("button",{type:"button",class:"w-[160px] h-[40px] bg-primaryColor text-white ml-10",onClick:q},"\u53BB\u7ED3\u7B97 ")])]),_:1},8,["loading"])])]),Ke,a(W),a(X,{modelValue:x.value,"onUpdate:modelValue":o[4]||(o[4]=t=>x.value=t),width:"700px",title:"\u65B0\u589E\u6536\u8D27\u5730\u5740","close-on-press-escape":!1,"close-on-click-modal":!1,"destroy-on-close":!0},{default:l(()=>[a(ge,{onCloseDialog:o[3]||(o[3]=t=>x.value=!1)})]),_:1},8,["modelValue"])],64)}}},eo=Z(Qe,[["__scopeId","data-v-9d43b728"]]);export{eo as default};
