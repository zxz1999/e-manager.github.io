import{A as I}from"./index.07080e2f.js";import{_ as X,s as Y,f as Z,u as ee,i as oe,g as $,H as A,h as p,A as te,r as c,L as se,o as h,c as y,J as ae,a as e,b as a,w as n,F as M,M as L,e as _,t as d,m as i,N as le,k as ne,n as de,Q as re,l as ce,p as ie,q as pe}from"./index.de7099bd.js";import{A as _e}from"./AddAddress.4df76707.js";const r=v=>(ie("data-v-dc08d5d7"),v=v(),pe(),v),ue={class:"py-6 border-b-2 border-solid my-shop-car-header","element-loading-text":"\u6B63\u5728\u63D0\u4EA4\u8BA2\u5355"},ge={class:"container m-auto flex flex-row items-center"},xe=r(()=>e("div",{class:"text-[22px] ml-10 flex-1"},"\u786E\u8BA4\u8BA2\u5355",-1)),me={class:"self-end"},fe={class:"el-dropdown-link text-gray-500 font-bold"},he=r(()=>e("span",{class:"mx-2 text-gray-400"},"|",-1)),ye=r(()=>e("span",null,"\u6211\u7684\u8BA2\u5355",-1)),ve={class:"bg-gray-100 overflow-auto"},be={class:"container m-auto mt-[40px] p-[20px] bg-white"},Ce=r(()=>e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u6536\u8D27\u5730\u5740",-1)),Ie={class:"address-list"},we=["onClick"],ke={class:"text-[18px]"},Ae={class:"text-gray-600"},Le={class:"address-all"},Se={class:"h-[200px] flex flex-row justify-center items-center border border-solid border-gray-400 p-6 box-border leading-7"},De=r(()=>e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u5546\u54C1\u53CA\u4F18\u60E0\u5377",-1)),Oe={class:"text-[12px]"},Ee={class:"text-primaryColor"},Ne=r(()=>e("div",{class:"flex flex-row h-[80px] items-center border-b border-solid border-gray-200"},[e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u914D\u9001\u65B9\u5F0F"),e("span",{class:"text-primaryColor ml-10 text-[14px]"},"\u5305\u90AE")],-1)),Ve=r(()=>e("div",{class:"flex flex-row h-[80px] items-center border-b border-solid border-gray-200"},[e("h2",{class:"text-gray-700 text-[18px] my-[10px]"},"\u53D1\u7968"),e("span",{class:"text-primaryColor ml-10 text-[14px]"},"\u7535\u5B50\u666E\u901A\u53D1\u7968\u4E2A\u4EBA\u5546\u54C1\u660E\u7EC6\u4FEE\u6539 >")],-1)),$e={class:"total-info-ul"},Me=r(()=>e("span",null,"\u5546\u54C1\u603B\u4EF6\u6570\uFF1A",-1)),Be={class:"text-primaryColor"},Ge=r(()=>e("span",null,"\u5546\u54C1\u603B\u4EF7\uFF1A",-1)),Pe={class:"text-primaryColor"},Ue=r(()=>e("li",null,[e("span",null,"\u6D3B\u52A8\u4F18\u60E0\uFF1A"),e("span",{class:"text-primaryColor"},"-0\u5143")],-1)),je=r(()=>e("li",null,[e("span",null,"\u4F18\u60E0\u5238\u62B5\u6263\uFF1A"),e("span",{class:"text-primaryColor"},"-0\u5143")],-1)),Re=r(()=>e("li",null,[e("span",null,"\u8FD0\u8D39\uFF1A"),e("span",{class:"text-primaryColor"},"0\u5143")],-1)),Te={class:"flex flex-row items-end"},qe=r(()=>e("span",null,"\u5E94\u4ED8\u603B\u989D\uFF1A",-1)),Fe={class:"text-primaryColor text-[28px]"},He={class:"flex flex-row justify-end mt-[20px] box-border"},Je=r(()=>e("div",{class:"h-[10px] bg-gray-100"},null,-1)),ze={__name:"CheckoutOrder",setup(v){const B=Y(),G=Z(),P=ee(),U=oe("baseURL"),u=$({pageIndex:1}),l=$({listData:[],pageCount:0,pageEnd:0,pageIndex:1,pageStart:1,totalCount:0}),j=A(()=>B._loginUserInfo),g=p(!1),S=s=>{g.value=!0,I.addressInfo.getMyAddressInfoList(u.pageIndex).then(o=>{l.listData=o.listData,l.pageCount=o.pageCount,l.pageEnd=o.pageEnd,l.pageIndex=o.pageIndex,l.pageStart=o.pageStart,l.totalCount=o.totalCount}).finally(()=>{g.value=!1})};S(u.pageIndex);const x=p(!1);te(x,(s,o)=>{s===!1&&S(u.pageIndex)});const b=p(-1),R=()=>{l.pageIndex<l.pageCount&&(u.pageIndex++,g.value=!0,I.addressInfo.getMyAddressInfoList(u.pageIndex).then(s=>{l.listData=s.listData,l.pageCount=s.pageCount,l.pageEnd=s.pageEnd,l.pageIndex=s.pageIndex,l.pageStart=s.pageStart,l.totalCount=s.totalCount}).finally(()=>{g.value=!1,console.log(l)}))},w=p(!1),m=p([]);(()=>{w.value=!0;let s=G.params.Ids;I.shopCarInfo.getMyCheckoutShopCarList(s).then(o=>{o.forEach(C=>{C.goodsInfo.goods_photo=JSON.parse(C.goodsInfo.goods_photo)}),m.value=o}).catch(()=>{L.alert("\u83B7\u53D6\u786E\u8BA4\u8BA2\u5355\u7684\u5546\u54C1\u6570\u636E\u5931\u8D25")}).finally(o=>{w.value=!1})})();const T=A(()=>{let s=0;return m.value.forEach(o=>{s+=o.car_goods_num}),s}),D=A(()=>{let s=0;return m.value.forEach(o=>{s+=o.car_goods_num*o.goodsInfo.goods_sale_price}),s}),k=p(!1),q=()=>{if(b.value===-1){L.alert("\u8BF7\u9009\u62E9\u6536\u8D27\u5730\u5740","\u63D0\u793A");return}k.value=!0;let s={address_id:l.listData[b.value].id,order_pay_type:1,goodsList:m.value.map(o=>({goods_id:o.goods_id,goods_num:o.car_goods_num}))};I.orderInfo.submitOrder(s).then(({data:o})=>{P.replace({name:"confirmOrder",params:{id:o}})}).catch(()=>{L.alert("\u63D0\u4EA4\u8BA2\u5355\u5931\u8D25","\u63D0\u793A",{type:"error"})}).finally(()=>{k.value=!1})};return(s,o)=>{const C=c("el-icon"),O=c("el-dropdown-item"),F=c("el-dropdown-menu"),H=c("el-dropdown"),E=c("el-button"),N=c("el-skeleton"),f=c("el-table-column"),J=c("el-image"),z=c("el-table"),Q=c("site-footer"),K=c("el-dialog"),W=se("loading");return h(),y(M,null,[ae((h(),y("div",ue,[e("div",ge,[e("div",{class:"iconfont icon-icon-xiaomiguishu text-[56px] text-[#ff6a00] ml-20 cursor-pointer",onClick:o[0]||(o[0]=t=>s.$router.replace({name:"Home"}))}),xe,e("div",me,[a(H,{onCommand:s.dropdownCommand},{dropdown:n(()=>[a(F,null,{default:n(()=>[a(O,{command:"customCenter"},{default:n(()=>[_("\u4EBA\u4E2A\u4E2D\u5FC3")]),_:1}),a(O,{divided:"",command:"clientLogOut"},{default:n(()=>[_("\u9000\u51FA\u767B\u5F55")]),_:1})]),_:1})]),default:n(()=>{var t;return[e("span",fe,[_(d((t=i(j))==null?void 0:t.custom_realName)+" ",1),a(C,{class:"el-icon--right"},{default:n(()=>[a(i(le))]),_:1})]),he,ye]}),_:1},8,["onCommand"])])])])),[[W,k.value]]),e("div",ve,[e("div",be,[Ce,a(N,{animated:"",loading:g.value},{default:n(()=>[e("div",Ie,[(h(!0),y(M,null,ne(l.listData,(t,V)=>(h(),y("div",{class:de(["address-item",{selected:b.value===V}]),onClick:Ke=>b.value=V,key:t.id},[e("div",ke,d(t.address_name),1),e("p",Ae,d(t.address_tel.substr(0,3)+"****"+t.address_tel.slice(-4)),1),e("p",Le,d(t.province)+" "+d(t.city)+" "+d(t.area)+" "+d(t.address_detail),1),a(E,{type:"text",class:"absolute right-6 bottom-2"},{default:n(()=>[_("\u4FEE\u6539")]),_:1})],10,we))),128)),e("div",Se,[a(E,{icon:i(re),type:"text",onClick:o[1]||(o[1]=t=>x.value=!0)},{default:n(()=>[_(" \u65B0\u589E\u5730\u5740 ")]),_:1},8,["icon"])])]),l.pageIndex<l.pageCount?(h(),y("div",{key:0,class:"flex flex-row h-[40px] justify-center items-center my-5 bg-gray-100 cursor-pointer text-gray-500",onClick:R}," \u52A0\u8F7D\u4E0B\u4E00\u9875\u5730\u5740\u6570\u636E ")):ce("",!0)]),_:1},8,["loading"]),a(N,{animated:"",loading:w.value},{default:n(()=>[De,a(z,{data:m.value,class:"w-full"},{default:n(()=>[a(f,{label:"\u7F16\u53F7",width:"60",align:"center"},{default:n(({$index:t})=>[_(d(t+1),1)]),_:1}),a(f,{label:"\u56FE\u7247",width:"100",align:"center"},{default:n(({row:t})=>[a(J,{src:i(U)+t.goodsInfo.goods_photo[0],class:"w-[60px] h-[60px]"},null,8,["src"])]),_:1}),a(f,{prop:"goodsInfo.goods_name",label:"\u5546\u54C1\u540D\u79F0"}),a(f,{label:"\u4EF7\u683C\u6570\u91CF",width:"200",align:"center"},{default:n(({row:t})=>[e("span",Oe,d(t.goodsInfo.goods_sale_price)+"\u5143 x "+d(t.car_goods_num),1)]),_:1}),a(f,{label:"\u603B\u4EF7",width:"120"},{default:n(({row:t})=>[e("span",Ee,d(t.goodsInfo.goods_sale_price*t.car_goods_num),1)]),_:1})]),_:1},8,["data"]),Ne,Ve,e("ul",$e,[e("li",null,[Me,e("span",Be,d(i(T))+"\u4EF6",1)]),e("li",null,[Ge,e("span",Pe,d(i(D))+"\u5143",1)]),Ue,je,Re,e("li",Te,[qe,e("span",Fe,d(i(D))+"\u5143",1)])]),e("div",He,[e("button",{type:"button",class:"w-[180px] h-[40px] border border-solid border-gray-400 text-gray-400",onClick:o[2]||(o[2]=t=>s.$router.back())},"\u8FD4\u56DE\u8D2D\u7269\u8F66 "),e("button",{type:"button",class:"w-[160px] h-[40px] bg-primaryColor text-white ml-10",onClick:q},"\u53BB\u7ED3\u7B97 ")])]),_:1},8,["loading"])])]),Je,a(Q),a(K,{modelValue:x.value,"onUpdate:modelValue":o[4]||(o[4]=t=>x.value=t),width:"700px",title:"\u65B0\u589E\u6536\u8D27\u5730\u5740","close-on-press-escape":!1,"close-on-click-modal":!1,"destroy-on-close":!0},{default:n(()=>[a(_e,{onCloseDialog:o[3]||(o[3]=t=>x.value=!1)})]),_:1},8,["modelValue"])],64)}}},Ze=X(ze,[["__scopeId","data-v-dc08d5d7"]]);export{Ze as default};
